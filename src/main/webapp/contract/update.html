<!DOCTYPE html>
<!--suppress ALL-->
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>编辑合同</title>
    <link rel="stylesheet" href="/static/layui/css/layui.css" media="all">
</head>
<script src="/static/layui/layui.js"></script>
<script src="/static/js/jquery-3.3.1.min.js"></script>
<body>
<br>
<div style="margin:0 auto; width:80%;height:auto;">
    <form class="layui-form" method="post" action="/contract/add1.do" enctype="multipart/form-data">
        <div class="layui-inline" style="float: left">
            <label class="layui-form-label"><span style="color:#FF0000;">*</span>合同名称</label>
            <div class="layui-input-block" style="width: 400px;height: 40px">
                <input align="left" type="text" id="a" th:value="${con.conname}" readonly style="border:0px;font-size:20px"/>
            </div>
        </div>
        <div class="layui-inline" style="float: right">
            <a href="javascript:window.opener=null;window.open('','_self');window.close()"
               class="layui-btn layui-icon layui-icon-return">返回</a>
            <a href="javascript:;" id="flush" class="layui-btn layui-icon layui-icon-refresh">刷新</a>
        </div>

        <div class="layui-form-item"
             style="border:1px solid ;background-color:lightyellow;height:35px;font-size: 20px;border-left: none;border-right: none;">
            客户信息
        </div>

        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label"><span style="color:#FF0000;">*</span>客户名称</label>
                <div class="layui-input-block" style="width: 400px;height: 40px">
                    <input type="text" th:value="${user.cliName}" readonly autocomplete="off" class="layui-input" style="width: 400px;height: 40px">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">所属行业</label>
                <div class="layui-input-block">
                    <input type="text" th:value="${user.busid}" readonly  autocomplete="off" class="layui-input" style="width: 400px;height: 40px">
                </div>
            </div>
        </div>

        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">所在城市</label>
                <div class="layui-input-block">
                    <input type="text" th:value="${user.city}" readonly autocomplete="off" class="layui-input" style="width: 400px;height: 40px">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">详细地址</label>
                <div class="layui-input-block">
                    <input type="text" th:value="${user.csite}" readonly autocomplete="off" class="layui-input" style="width: 400px;height: 40px">
                </div>
            </div>
        </div>

        <div class="layui-form-item"
             style="border:1px solid ;background-color:lightyellow;height:35px;font-size: 20px;border-left: none;border-right: none;">
            合同信息
        </div>

        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label"><span style="color:#FF0000;">*</span>合同名称</label>
                <div class="layui-input-block">
                    <input type="hidden" id="e" name="conUcid">
                    <input type="hidden" id="f" name="conname">
                    <input type="text" onkeyup="add(this.value)" placeholder="请输入合同名称" lay-verify="conname" autocomplete="off" class="layui-input"
                           style="width: 400px;height: 40px">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label"><span style="color:#FF0000;">*</span>合同编号</label>
                <div class="layui-input-block">
                    <input type="text" name="serial" th:value="${con.serial}" placeholder="请输入合同编号"  lay-verify="serial" autocomplete="off" class="layui-input"
                           style="width: 400px;height: 40px">
                </div>
            </div>
        </div>

        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">合同金额</label>
                <div class="layui-input-block">
                    <input type="text" name="conSum" th:value="${con.conSum}" placeholder="请输入合同金额" autocomplete="off" class="layui-input"
                           style="width: 400px;height: 40px">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label"><span style="color:#FF0000;">*</span>签约日期</label>
                <div class="layui-input-block">
                    <input type="text" id="conStartdate" th:value="${con.conStartdate}" lay-verify="conStartdate" name="conStartdate" placeholder="yyyy-MM-dd" class="layui-input"
                           style="width: 400px;height: 40px">
                </div>
            </div>
        </div>

        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">生效日期</label>
                <div class="layui-input-block">
                    <input type="text" id="conPredate" th:value="${con.conPredate}" name="conPredate" placeholder="yyyy-MM-dd" class="layui-input"
                           style="width: 400px;height: 40px">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">服务期至</label>
                <div class="layui-input-block">
                    <input type="text" id="conEnddate" th:value="${con.conEnddate}" name="conEnddate" placeholder="yyyy-MM-dd" class="layui-input"
                           style="width: 400px;height: 40px">
                </div>
            </div>
        </div>

        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label"><span style="color:#FF0000;">*</span>对方联系人</label>
                <div class="layui-input-block">
                    <input type="text" name="conContacts" th:value="${con.conContacts}" placeholder="请输入对方联系人" lay-verify="conContacts" autocomplete="off" class="layui-input"
                           style="width: 400px;height: 40px">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">固定电话</label>
                <div class="layui-input-block">
                    <input type="text" name="conOffphone" th:value="${con.conOffphone}" placeholder="请输入固定电话" autocomplete="off" class="layui-input"
                           style="width: 400px;height: 40px">
                </div>
            </div>
        </div>

        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">移动电话</label>
                <div class="layui-input-block">
                    <input type="text" name="conPhone" th:value="${con.conPhone}" placeholder="请输入移动电话" autocomplete="off" class="layui-input"
                           style="width: 400px;height: 40px">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">邮件/QQ</label>
                <div class="layui-input-block">
                    <input type="text" name="conMail" th:value="${con.conMail}" placeholder="请输入邮件/QQ" autocomplete="off" class="layui-input"
                           style="width: 400px;height: 40px">
                </div>
            </div>
        </div>

        <div class="layui-form-item layui-form-text">
            <div class="layui-inline">
                <label class="layui-form-label">主要技术条款</label>
                <div class="layui-input-block">
                    <textarea name="technical" th:value="${con.technical}" placeholder="请输入主要技术条款" class="layui-textarea" style="width: 925px;height: 40px"></textarea>
                </div>
            </div>
        </div>

        <div class="layui-form-item layui-form-text">
            <div class="layui-inline">
                <label class="layui-form-label">主要商务条款</label>
                <div class="layui-input-block">
                    <textarea name="clause" th:value="${con.clause}" placeholder="请输入主要商务条款" class="layui-textarea" style="width: 925px;height: 40px"></textarea>
                </div>
            </div>
        </div>

        <div class="layui-form-item layui-form-text">
            <div class="layui-inline">
                <label class="layui-form-label">相关附件</label>
                <div class="layui-input-block">
                    <input type="file" name="file" class="layui-input"
                           style="width: 925px;height: 40px">
                </div>
            </div>
        </div>

        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">合同所属部门</label>
                <div class="layui-input-block">
                    <input type="text" th:value="${d.udname}" readonly autocomplete="off" class="layui-input" style="width: 400px;height: 40px">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">关联人员</label>
                <div class="layui-input-block">
                    <input type="hidden" name="conUid" value="1">
                    <input type="text" name="conUname" th:value="${u.uname}" readonly autocomplete="off" class="layui-input"
                           style="width: 400px;height: 40px">
                </div>
            </div>
        </div>

        <br>
        <div style="text-align: center;">
            <div class="layui-form-item">
                <div class="layui-input-block">
                    <button lay-submit="" class="layui-btn layui-btn-radius layui-btn-normal">保存</button>
                    <a href="javascript:window.opener=null;window.open('','_self');window.close()"
                       class="layui-btn layui-btn-radius layui-btn-normal">取消</a>
                </div>
            </div>
        </div>
    </form>
</div>
<script>
    var st = "";
    var add = function (a) {
        var str = st + "-" + a;
        $("#a").val(str);
        $("#f").val(str);
        if(a==""){
            $("#a").val(st);
            $("#f").val(st);
        }
    }

    layui.use(['form', 'upload', 'jquery', 'laydate'], function () {
        var form = layui.form;
        var $ = layui.jquery;//异步
        var upload = layui.upload;
        var laydate = layui.laydate;

        laydate.render({
            elem:'#conStartdate'
        });
        laydate.render({
            elem:'#conPredate'
        });
        laydate.render({
            elem:'#conEnddate'
        });
        form.on('select(test)', function (data) {
            var flag = data.value;
            if (flag == 0) {
                $("#a").val("");
                $("#b").val("");
                $("#c").val("");
                $("#d").val("");
                $("#e").val("");
            } else {
                $.ajax({
                    type: "post",
                    url: "/contract/user.do?ucid=" + flag,
                    dataType: "json",
                    success: function (data) {
                        st = data.data.cliName;
                        $("#a").val(data.data.cliName);
                        $("#b").val(data.data.cliBusiness.clibusname);
                        $("#c").val(data.data.city);
                        $("#d").val(data.data.csite);
                        $("#e").val(data.data.ucid);
                    }
                });
            }
        });

        form.verify({
            test:function (value, item) {
                if (value == 0) {
                    return '请选择客户名称';
                }
            },
            conname:function (value, item) {
                if (value.length==0 || value.trim().length==0) {
                    return '请输入合同名称';
                }
            },
            serial:function (value, item) {
                if (value.length==0 || value.trim().length==0) {
                    return '请输入合同编号';
                }
            },
            conStartdate:function (value, item) {
                if (value.length==0 || value.trim().length==0) {
                    return '请选择签约日期';
                }
            },
            conContacts:function (value, item) {
                if (value.length==0 || value.trim().length==0) {
                    return '请输入对方联系人';
                }
            }
        });

    });
</script>
</body>
</html>